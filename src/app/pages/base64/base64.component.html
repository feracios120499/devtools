<div class="dt-container">
  <app-page-header>Tool for encoding and decoding text using Base64 format</app-page-header>
  
  <!-- Блок переключателей операций -->
  <div class="mb-3 px-3 flex items-center">
    <div class="flex items-center gap-3">
      <p-radioButton [(ngModel)]="activeTab" inputId="decode" name="operation" [value]="1" (onClick)="switchMode()"></p-radioButton>
      <label for="decode">Decode from Base64 to Text</label>

      <p-radioButton [(ngModel)]="activeTab" inputId="encode" name="operation" [value]="2" (onClick)="switchMode()"></p-radioButton>
      <label for="encode">Encode from Text to Base64</label>
    </div>
  </div>
  
  <!-- Основной контейнер с редакторами -->
  <div class="dt-editors">
    <!-- Левая колонка - Input Text -->
    <div class="col flex flex-col h-full">
      <div class="card p-3 surface-card shadow-sm flex-1 flex flex-col overflow-hidden h-full">
        <!-- Заголовок -->
        <div class="flex justify-between items-center h-10">
          <h5 class="text-xl font-medium text-800 m-0">{{ activeTab == 2 ? 'Input Text' : 'Input Base64' }}</h5>
        </div>
        <!-- Отступ для дропдауна -->
        <div class="mb-1"></div>

        <!-- Textarea для серверного рендеринга -->
        <textarea *ngIf="!isBrowser" 
          [(ngModel)]="inputCode" 
          (ngModelChange)="processText()"
          class="w-full p-2 border-1 surface-100 font-mono flex-1">
        </textarea>
        
        <!-- Monaco editor для браузера -->
        <div *ngIf="isBrowser"
          class="w-full h-full border-1 surface-border rounded-md flex-1 position-relative monaco-container dt-editors-editor"
          [class.fullscreen-editor]="isInputFullscreen" #inputEditorContainer>
          <div class="dt-editors-editor-actions">
            <div class="flex justify-between p-2">
              <div class="flex gap-3 align-items-center">
                <button pButton type="button" [outlined]="true" label="Sample" (click)="loadSample()"
                  class="p-button-sm" severity="contrast">
                  <i-tabler name="code" class="icon-sm"> </i-tabler>
                </button>
                <button pButton type="button" [outlined]="true" label="Paste" class="p-button-sm"
                  (click)="pasteFromClipboard()" severity="contrast">
                  <i-tabler name="clipboard" class="icon-sm"></i-tabler>
                </button>
                <button pButton type="button" [outlined]="true" label="Clear" (click)="clearText()" severity="danger"
                  class=" p-button-sm">
                  <i-tabler name="trash" class="icon-sm"></i-tabler>
                </button>
              </div>
              <div class="flex align-items-center">
                <button *ngIf="!isInputFullscreen" pButton type="button" (click)="toggleFullscreen('input')"
                  severity="contrast" class="p-button-text p-button-sm">
                  <i-tabler name="arrows-maximize" class="icon-md"></i-tabler>
                </button>
                <button *ngIf="isInputFullscreen" pButton type="button" (click)="toggleFullscreen('input')"
                  severity="contrast" class="p-button-text p-button-sm">
                  <i-tabler name="arrows-minimize" class="icon-md"></i-tabler>
                </button>
              </div>
            </div>
            <hr>
          </div>
          <ngx-monaco-editor
            #inputMonacoEditor
            [options]="inputEditorOptions" 
            [(ngModel)]="inputCode" 
            (ngModelChange)="processText()"
            class="w-full h-full">
          </ngx-monaco-editor>
        </div>
      </div>
    </div>
    
    <!-- Правая колонка - Output Text -->
    <div class="col flex flex-col h-full">
      <div class="card p-3 surface-card shadow-sm flex-1 flex flex-col overflow-hidden h-full">
        <!-- Заголовок -->
        <div class="flex justify-between items-center h-10">
          <h5 class="text-xl font-medium text-800 m-0">{{ activeTab == 1 ? 'Decoded Text' : 'Base64 Output' }}</h5>
        </div>
        <!-- Отступ для дропдауна -->
        <div class="mb-1"></div>
        
        <!-- Textarea для серверного рендеринга -->
        <textarea *ngIf="!isBrowser" 
          [(ngModel)]="outputCode" 
          readonly
          class="w-full p-2 border-1 surface-100 font-mono flex-1">
        </textarea>
        
        <!-- Monaco editor для браузера -->
        <div *ngIf="isBrowser"
          class="w-full h-full border-1 surface-border rounded-md flex-1 position-relative monaco-container dt-editors-editor"
          [class.fullscreen-editor]="isOutputFullscreen" #outputEditorContainer>
          <div class="dt-editors-editor-actions">
            <div class="flex justify-between p-2">
              <div class="flex gap-3 align-items-center">
                <button pButton type="button" [outlined]="true" label="Copy" (click)="copyToClipboard()"
                  [disabled]="!outputCode" class="p-button-sm" severity="contrast">
                  <i-tabler name="copy" class="icon-sm"></i-tabler>
                </button>
                <button pButton type="button" [outlined]="true" label="Download" (click)="downloadText()"
                  [disabled]="!outputCode" class="p-button-sm" severity="contrast">
                  <i-tabler name="download" class="icon-sm"></i-tabler>
                </button>
              </div>
              <div class="flex align-items-center">
                <button *ngIf="!isOutputFullscreen" pButton type="button" (click)="toggleFullscreen('output')"
                  severity="contrast" class="p-button-text p-button-sm">
                  <i-tabler name="arrows-maximize" class="icon-md"></i-tabler>
                </button>
                <button *ngIf="isOutputFullscreen" pButton type="button" (click)="toggleFullscreen('output')"
                  severity="contrast" class="p-button-text p-button-sm">
                  <i-tabler name="arrows-minimize" class="icon-md"></i-tabler>
                </button>
              </div>
            </div>
            <hr>
          </div>
          <ngx-monaco-editor
            #outputMonacoEditor
            [options]="outputEditorOptions" 
            [(ngModel)]="outputCode" 
            class="w-full h-full">
          </ngx-monaco-editor>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Информационный раздел -->
  <div class="mt-4 p-3 border-round-lg surface-card shadow-sm border-1 surface-border info-section dt-about">
    <h3 class="text-xl font-semibold mb-2">About Base64 Encoding</h3>
    <p class="mb-2 text-sm">
      Base64 is a binary-to-text encoding scheme that represents binary data in an ASCII string format by translating it into a radix-64 representation. It is commonly used to encode binary data for transmission over media that is designed to deal with textual data.
    </p>
    <p class="mb-2 text-sm">
      <strong>When to use Base64 encoding:</strong>
      Base64 is commonly used when transferring binary data in environments that only support text, such as sending email attachments, storing complex data in JSON, or including binary data in XML files.
    </p>
  </div>
  
  <!-- Toast -->
  <p-toast position="bottom-right"></p-toast>
</div> 